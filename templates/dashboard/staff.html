{% extends 'partials/base.html' %}

{% block title %} Staff Page {% endblock %}

{% block content %} 

    <div class="container mt-5">
        <table class="table table-bordered" id="dataTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Age</th>
                    <th>City</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>John</td>
                    <td>25</td>
                    <td>New York</td>
                </tr>
                <tr>
                    <td>Jane</td>
                    <td>30</td>
                    <td>London</td>
                </tr>
            </tbody>
        </table>
        <button class="btn btn-success" onclick="exportTableToExcel()">Export to Excel</button>

    </div>
    
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script>
    function exportTableToExcel() {
        const table = document.getElementById("dataTable");
        const workbook = XLSX.utils.table_to_book(table);

        // Generate a filename with the current date
        const date = new Date();
        const formattedDate = date.toISOString().split('T')[0]; // Format as YYYY-MM-DD
        const filename = `OrderForm_${formattedDate}.xlsx`;

        XLSX.writeFile(workbook, filename);
}
</script>

{% endblock %}